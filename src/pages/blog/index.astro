---
import Layout from '../../layouts/Layout.astro';
import BlogPostCard from '../../components/BlogPostCard.astro';

const posts = Object.values(await import.meta.glob('./*.md', { eager: true }))
  .sort((a, b) => new Date(b.frontmatter.pubDate).getTime() - new Date(a.frontmatter.pubDate).getTime());
---

<Layout title="Blog">
  <div role="region" aria-labelledby="blog-heading">
    <header class="flex justify-between items-center mb-8">
      <h1 id="blog-heading" class="text-xl font-bold">Blog Posts</h1>
      <a href="/rss.xml" class="text-xs hover:underline focus:underline focus:outline-none" target="_blank" rel="noopener noreferrer" aria-label="RSS Feed (opens in new window)">
        RSS Feed<span class="sr-only"> (opens in new window)</span>
      </a>
    </header>
    <div class="space-y-8" role="list">
      {posts.map((post) => (
        <BlogPostCard 
          title={post.frontmatter.title}
          url={post.url}
          pubDate={post.frontmatter.pubDate}
          description={post.frontmatter.description}
        />
      ))}
    </div>
  </div>
</Layout>
